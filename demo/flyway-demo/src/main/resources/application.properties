# Application Runtime Configuration (DML only user for the operational application)
# H2 Database: file-based (persistent) or mem: (in-memory)
# File-based: jdbc:h2:file:./data/flyway_demo
# In-memory: jdbc:h2:mem:flyway_demo
spring.datasource.url=${DB_URL:jdbc:h2:file:./data/flyway_demo}
spring.datasource.username=${APP_USER:sa}
spring.datasource.password=${APP_PASSWORD:}

# Flyway Configuration (Dedicated DDL user, secured via a secret vault)
spring.flyway.url=${DB_URL:jdbc:h2:file:./data/flyway_demo}
spring.flyway.user=${FLYWAY_USER:sa}
spring.flyway.password=${FLYWAY_PASSWORD:}

# Migration Script Locations (Leveraging active Spring profile for data separation)
spring.flyway.locations=classpath:db/migration/common,classpath:db/migration/${spring.profiles.active:default}

# Flyway Configuration Options
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=false
spring.flyway.validate-on-migrate=true
spring.flyway.clean-disabled=true

# Code Analysis (Flyway 11.x)
spring.flyway.code-analysis.enabled=${FLYWAY_CODE_ANALYSIS_ENABLED:false}
spring.flyway.code-analysis.scope=${FLYWAY_CODE_ANALYSIS_SCOPE:all}

# Callback Registration
spring.flyway.callbacks=com.example.flyway.callbacks.MigrationLifecycleCallback

